local tmp = "AAAABBBB"
local printClosure = 0;

# Convert string to little endian int
for(local i=7; i>=0; i--) {
    local cur = tmp[i] & 0xff;
    printClosure += cur;
    if(i != 0) {
        printClosure = printClosure << 8;
    }
    print(format("printClosure: 0x%016x, cur=0x%02x\n", printClosure, cur));
}

print(format("[+] Got print _function leak: 0x%016x!\n", printClosure))
